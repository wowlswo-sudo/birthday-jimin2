<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì§€ë¯¼ì•„ ìƒì¼ ì¶•í•˜í•´â™¡ ! ğŸ‰</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Jua&family=Noto+Sans+KR:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Jua', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #FFFF99 0%, #FFFF66 50%, #FFEB3B 100%);
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            overflow-x: hidden;
            animation: bgGlow 3s ease-in-out infinite alternate;
            touch-action: none; /* ìŠ¤ì™€ì´í”„ ì‹œ í™”ë©´ ìŠ¤í¬ë¡¤ ë°©ì§€ */
        }
        
        @keyframes bgGlow {
            0% { filter: brightness(1.05); }
            100% { filter: brightness(1.15); }
        }

        /* -------------------
           ê²Œì„ ê´€ë ¨ ìŠ¤íƒ€ì¼
           ------------------- */
        .maze-container {
            width: 95%;
            max-width: 500px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            box-shadow: 0 20px 40px rgba(255,105,180,0.3);
            border: 4px solid #FFD700;
            z-index: 10;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .maze-title {
            font-size: 1.8em;
            color: #FF69B4;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(255,215,0,0.3);
        }

        .maze-instruction {
            font-size: 1.2em;
            color: #FF69B4;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .maze-hint {
            margin-top: 20px;
            font-size: 1em;
            color: #666;
        }

        #gameCanvas {
            border-radius: 15px;
            background: #FFF;
            border: 4px solid #FFCA28;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            max-width: 100%;
            touch-action: none;
        }

        /* -------------------
           ì¶•í•˜ í™”ë©´ ìŠ¤íƒ€ì¼
           ------------------- */
        .container {
            max-width: 800px;
            width: 95%;
            padding: 40px 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            box-shadow: 0 20px 40px rgba(255,105,180,0.3);
            backdrop-filter: blur(10px);
            position: relative;
            z-index: 10;
            border: 4px solid #FFD700;
            display: none; 
        }

        .container.show {
            display: block;
            animation: fadeIn 1s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        
        h1 {
            font-size: 2.5em;
            color: #FF69B4;
            text-shadow: 3px 3px 6px rgba(255,215,0,0.5);
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
        
        .message {
            font-size: 1.2em;
            line-height: 1.6;
            margin: 20px 0;
            color: #FF69B4;
            font-weight: 600;
        }
        
        .photo-gallery {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }
        
        .photo {
            width: 100%;
            max-width: 400px;
            height: auto;
            border-radius: 20px;
            object-fit: cover;
            border: 8px solid #FFD700;
            box-shadow: 0 10px 20px rgba(255,215,0,0.4);
        }
        
        .letter {
            background: linear-gradient(135deg, #FFF9C4, #FFFACD);
            padding: 25px;
            border-radius: 25px;
            margin: 30px 0;
            border: 3px solid #FFD700;
            font-size: 1.1em;
            color: #555;
            line-height: 1.7;
            text-align: left;
        }
        
        .hearts, .stars {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .heart {
            position: absolute;
            color: #FF69B4;
            font-size: 25px;
            animation: floatHeart 4s ease-in-out infinite;
            opacity: 0.7;
        }
        
        .star {
            position: absolute;
            color: #FFD700;
            font-size: 20px;
            animation: twinkle 2s infinite;
        }
        
        .heart-deco {
            font-size: 1.5em;
            display: inline-block;
            animation: heartbeat 1.5s ease-in-out infinite;
            margin: 5px;
        }
        
        @keyframes floatHeart {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            50% { opacity: 0.8; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        @keyframes heartbeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        @media (min-width: 768px) {
            h1 { font-size: 3.5em; }
            .maze-title { font-size: 2.2em; }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>
    <div class="hearts" id="hearts"></div>
    
    <!-- ê²Œì„ í™”ë©´ -->
    <div class="maze-container" id="gameScreen">
        <h2 class="maze-title">ğŸ® í–„ìŠ¤í„°ì˜ ì„ ë¬¼ ì°¾ê¸° ğŸ¹</h2>
        <p class="maze-instruction">
            ğŸ’› ì§€ë¯¼ì´ì˜ ìƒì¼ ì„ ë¬¼ì„ ì°¾ì•„ì¤˜! ğŸ’›<br>
            ê·€ì—¬ìš´ í–„ìŠ¤í„°ë¥¼ ì›€ì§ì—¬(ë°©í–¥í‚¤/í„°ì¹˜)<br>
            ê³¨ ì§€ì ê¹Œì§€ ë„ì°©í•˜ì„¸ìš”!
        </p>

        <canvas id="gameCanvas"></canvas>
        <p class="maze-hint">ğŸ’¡ íŒíŠ¸: ë²½ì— ë¶€ë”ªíˆì§€ ì•Šë„ë¡ ì¡°ì‹¬íˆ ì´ë™í•˜ì„¸ìš”!</p>
    </div>

    <!-- ì¶•í•˜ í™”ë©´ -->
    <div class="container" id="birthdayScreen">
        <h1>ğŸ’› ì§€ë¯¼ì•„ ìƒì¼ ì¶•í•˜í•´ ğŸ’›</h1>
        
        <div class="heart-deco">ğŸ’•ğŸ’–ğŸ’•</div>
        
        <p class="message">
            ì˜¬í•´ëŠ” ë” ê±´ê°•í•˜ê³  ë” ë°ì€ ëª¨ìŠµìœ¼ë¡œ<br>
            ë…¸ë€ í–‡ì‚´ ê°™ì€ í–‰ë³µì´ ê°€ë“í•˜ê¸¸! ğŸ’›âœ¨
        </p>
        
        <div class="heart-deco">ğŸ’—ğŸ’ğŸ’—</div>
        
        <div class="photo-gallery">
            <img src="photo1.png" alt="ìš°ë¦¬ ì¶”ì–µ1" class="photo"> 
        </div>

        <div class="heart-deco">ğŸ’“ğŸ’ğŸ’“</div>
        
        <div class="letter">
            ğŸ“ <strong style="color: #FF69B4;">ë„ˆì—ê²Œ ë³´ë‚´ëŠ” í¸ì§€ ğŸ’Œ</strong><br><br>
            ì¶”ìš´ ê²¨ìš¸ ë™ì•ˆ í˜ë“  ì¹˜ë£Œ ë°›ëŠë¼ ë§ì´ í˜ë“¤ì—ˆì§€?<br> 
            ì´ì œ ì ì  ìˆ˜ì¹˜ë„ ì¢‹ì•„ì§€ê³  ì»¨ë””ì…˜ë„ ì ì  ë” ì¢‹ì•„ì§ˆê±°ë¼ ë¯¿ì–´!<br><br>
            ë‚´ë…„ ìƒì¼ì—ëŠ” ë” ì¢‹ì•„ì§„ ì»¨ë””ì…˜ìœ¼ë¡œ ë” ì¢‹ì€ ê³³ì—ì„œ ë” ë§›ìˆëŠ” ê±° ë¨¹ì ğŸ’›<br>
            ì‚¬ë‘í•˜ê³  í•­ìƒ ì‘ì›í•´! ğŸ’•
        </div>
        
        <div class="heart-deco">ğŸ’–ğŸ’•ğŸ’—ğŸ’ğŸ’“ğŸ’ğŸ’–</div>
    </div>
    
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        const TILE_COUNT = 9;
        let TILE_SIZE = 40;
        
        // ë§µ ë°ì´í„° (0:ê¸¸, 1:ë²½, 2:í•˜íŠ¸ì•„ì´í…œ, 9:ë„ì°©ì )
        const map = [
            [0, 0, 0, 1, 2, 0, 0, 1, 2],
            [1, 1, 0, 1, 1, 1, 0, 1, 0],
            [2, 0, 0, 0, 0, 0, 0, 0, 0],
            [1, 1, 1, 1, 0, 1, 1, 1, 1],
            [0, 0, 2, 1, 0, 0, 0, 0, 0],
            [0, 1, 0, 1, 1, 1, 1, 1, 0],
            [0, 1, 0, 0, 0, 0, 0, 0, 0],
            [0, 1, 1, 1, 0, 1, 0, 1, 1],
            [0, 2, 0, 0, 0, 1, 0, 0, 9]
        ];

        const player = {
            gridX: 0, gridY: 0, 
            x: 0, y: 0,
            dir: 1
        };

        let particles = [];

        function resize() {
            const maxSize = Math.min(window.innerWidth - 60, 360);
            canvas.width = maxSize;
            canvas.height = maxSize;
            TILE_SIZE = maxSize / TILE_COUNT;
            
            player.x = player.gridX * TILE_SIZE;
            player.y = player.gridY * TILE_SIZE;
        }
        window.addEventListener('resize', resize);
        resize();

        function gameLoop() {
            update();
            draw();
            requestAnimationFrame(gameLoop);
        }

        function update() {
            const targetX = player.gridX * TILE_SIZE;
            const targetY = player.gridY * TILE_SIZE;
            player.x += (targetX - player.x) * 0.2;
            player.y += (targetY - player.y) * 0.2;

            for (let i = particles.length - 1; i >= 0; i--) {
                particles[i].life--;
                particles[i].x += particles[i].vx;
                particles[i].y += particles[i].vy;
                if (particles[i].life <= 0) particles.splice(i, 1);
            }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (let y = 0; y < TILE_COUNT; y++) {
                for (let x = 0; x < TILE_COUNT; x++) {
                    const type = map[y][x];
                    const posX = x * TILE_SIZE;
                    const posY = y * TILE_SIZE;

                    if (type === 1) { // ì¹˜ì¦ˆ ë²½
                        ctx.fillStyle = '#FFD54F';
                        drawRoundedRect(posX + 1, posY + 1, TILE_SIZE - 2, TILE_SIZE - 2, 5);
                        ctx.fillStyle = '#FFECB3';
                        ctx.beginPath(); ctx.arc(posX + TILE_SIZE*0.3, posY + TILE_SIZE*0.3, TILE_SIZE*0.1, 0, Math.PI*2); ctx.fill();
                    } else if (type === 2) { // í•˜íŠ¸
                        const float = Math.sin(Date.now() / 200) * 3;
                        ctx.font = `${TILE_SIZE * 0.6}px Arial`;
                        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
                        ctx.fillText('ğŸ’–', posX + TILE_SIZE/2, posY + TILE_SIZE/2 + float);
                    } else if (type === 9) { // ë„ì°© ì„ ë¬¼
                        const scale = 1 + Math.sin(Date.now() / 300) * 0.1;
                        ctx.save();
                        ctx.translate(posX + TILE_SIZE/2, posY + TILE_SIZE/2);
                        ctx.scale(scale, scale);
                        ctx.font = `${TILE_SIZE * 0.7}px Arial`;
                        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
                        ctx.fillText('ğŸ', 0, 0);
                        ctx.restore();
                    }
                }
            }

            particles.forEach(p => {
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            });

            // í”Œë ˆì´ì–´
            ctx.save();
            ctx.translate(player.x + TILE_SIZE/2, player.y + TILE_SIZE/2);
            if (player.dir === -1) ctx.scale(-1, 1);
            const bounce = Math.abs(Math.sin(Date.now() / 150)) * 5;
            ctx.font = `${TILE_SIZE * 0.8}px Arial`;
            ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
            ctx.fillText('ğŸ¹', 0, -bounce);
            ctx.restore();
        }

        function drawRoundedRect(x, y, w, h, r) {
            ctx.beginPath(); ctx.moveTo(x+r, y); ctx.lineTo(x+w-r, y); ctx.quadraticCurveTo(x+w, y, x+w, y+r);
            ctx.lineTo(x+w, y+h-r); ctx.quadraticCurveTo(x+w, y+h, x+w-r, y+h); ctx.lineTo(x+r, y+h);
            ctx.quadraticCurveTo(x, y+h, x, y+h-r); ctx.lineTo(x, y+r); ctx.quadraticCurveTo(x, y, x+r, y); ctx.fill();
        }

        function move(dx, dy) {
            const nextX = player.gridX + dx;
            const nextY = player.gridY + dy;

            if (nextX < 0 || nextX >= TILE_COUNT || nextY < 0 || nextY >= TILE_COUNT) return;
            if (map[nextY][nextX] === 1) return;

            if (dx !== 0) player.dir = dx;

            if (map[nextY][nextX] === 2) {
                map[nextY][nextX] = 0;
                createParticles(nextX * TILE_SIZE + TILE_SIZE/2, nextY * TILE_SIZE + TILE_SIZE/2, 'heart');
            }

            player.gridX = nextX;
            player.gridY = nextY;
            createParticles(player.x + TILE_SIZE/2, player.y + TILE_SIZE, 'dust');

            if (map[nextY][nextX] === 9) {
                setTimeout(() => {
                    document.getElementById('gameScreen').style.display = 'none';
                    document.getElementById('birthdayScreen').classList.add('show');
                    startBgAnimations();
                }, 500);
            }
        }

        function createParticles(x, y, type) {
            for (let i = 0; i < 5; i++) {
                particles.push({
                    x: x, y: y,
                    vx: (Math.random() - 0.5) * 4,
                    vy: (Math.random() - 0.5) * 4,
                    life: 20,
                    size: Math.random() * 3 + 2,
                    color: type === 'heart' ? '#FF69B4' : '#FFF'
                });
            }
        }

        // í„°ì¹˜ ìŠ¤ì™€ì´í”„ ê¸°ëŠ¥ (í‚¤íŒ¨ë“œ ëŒ€ì‹ )
        let touchStartX = 0;
        let touchStartY = 0;

        canvas.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€
        }, { passive: false });

        canvas.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            const dx = touchEndX - touchStartX;
            const dy = touchEndY - touchStartY;

            // í„°ì¹˜ ì´ë™ ê±°ë¦¬ê°€ ë„ˆë¬´ ì§§ìœ¼ë©´ ë¬´ì‹œ (ì˜¤í„°ì¹˜ ë°©ì§€)
            if (Math.abs(dx) < 20 && Math.abs(dy) < 20) return;

            if (Math.abs(dx) > Math.abs(dy)) {
                move(dx > 0 ? 1 : -1, 0); // ì¢Œìš°
            } else {
                move(0, dy > 0 ? 1 : -1); // ìƒí•˜
            }
        });

        // PC í‚¤ë³´ë“œ ì§€ì›
        document.addEventListener('keydown', (e) => {
            if (document.getElementById('gameScreen').style.display === 'none') return;
            if (e.key === 'ArrowUp') move(0, -1);
            if (e.key === 'ArrowDown') move(0, 1);
            if (e.key === 'ArrowLeft') move(-1, 0);
            if (e.key === 'ArrowRight') move(1, 0);
        });

        // ì‹œì‘
        requestAnimationFrame(gameLoop);

        function startBgAnimations() {
            function createItem(className, text, duration) {
                const item = document.createElement('div');
                item.className = className;
                item.innerHTML = text;
                item.style.left = Math.random() * 100 + '%';
                
                if(className === 'heart') {
                    item.style.animationDuration = (Math.random() * 3 + 3) + 's';
                    document.getElementById('hearts').appendChild(item);
                } else {
                    item.style.top = Math.random() * 100 + '%';
                    document.getElementById('stars').appendChild(item);
                }
                
                setTimeout(() => item.remove(), duration);
            }

            setInterval(() => createItem('star', 'âœ¨', 4000), 400);
            setInterval(() => {
                const hearts = ['ğŸ’•', 'ğŸ’–', 'ğŸ’—', 'ğŸ’', 'ğŸ’“', 'ğŸ’'];
                createItem('heart', hearts[Math.floor(Math.random() * hearts.length)], 7000);
            }, 800);
        }
    </script>
</body>
</html>
